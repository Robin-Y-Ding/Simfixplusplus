The real buggy line:
if ( ( long ) x == x ) { 

The real patch line:
if ( ( long ) x == x && ! isNegativeZero ( x ) ) { 

----------------------Similar Code (Buggy, patch):---------------------


if ( x != x ) { return x ; }
if ( Double . isNaN ( x ) ) { return x ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( x != x ) { return x ; }
if ( Double . isNaN ( x ) ) { return x ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( x != x ) { return x ; }
if ( Double . isNaN ( x ) ) { return x ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( x != x ) { return x ; }
if ( Double . isNaN ( x ) ) { return x ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( x != x ) { return x ; }
if ( Double . isNaN ( x ) ) { return x ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( ! forward ) h = - h ;
if ( ! forward ) { h = - h ; }
--File: src_main_java_org_apache_commons_math_ode_sampling_StepNormalizer.java



if ( getRhs () == null ) { return; }
if ( getRhs () == null || shouldPreserve () ) { return; }
--File: src_com_google_javascript_jscomp_ijs_PotentialDeclaration.java



if ( defs == null ) { return; }
if ( defs . isEmpty () ) { return; }
--File: src_com_google_javascript_jscomp_DefinitionUseSiteFinder.java



if ( y . equals ( py ) ) break;
if ( y . equals ( py ) ) { break; }
--File: src_main_java_org_apache_commons_math_dfp_DfpMath.java



float sign = sign ( x ) ;
float sign = indicator ( x ) ;
--File: src_java_org_apache_commons_math_util_MathUtils.java



double d = ( x - mu ) ;
double d = x - mu ;
--File: src_main_java_org_apache_commons_math_distribution_SaddlePointExpansion.java



double sign = sign ( x ) ;
double sign = indicator ( x ) ;
--File: src_java_org_apache_commons_math_util_MathUtils.java



if ( nameNode == null ) return;
if ( nameNode == null ) { return; }
--File: src_com_google_javascript_jscomp_FunctionInjector.java



if ( x != x ) { return Double.NaN ; }
if ( Double . isNaN ( x ) ) { return Double.NaN ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



if ( x != x ) { return Double.NaN ; }
if ( Double . isNaN ( x ) ) { return Double.NaN ; }
--File: src_main_java_org_apache_commons_math4_util_FastMath.java



double fl = Math . floor ( x ) ;
double fl = FastMath . floor ( x ) ;
--File: src_main_java_org_apache_commons_math_distribution_AbstractIntegerDistribution.java



if ( boundaries == null ) return x ;
if ( boundaries == null ) { return x ; }
--File: src_main_java_org_apache_commons_math_optimization_direct_CMAESOptimizer.java



if ( boundaries == null ) return x ;
if ( boundaries == null ) { return x ; }
--File: src_main_java_org_apache_commons_math_optimization_direct_CMAESOptimizer.java



if ( isUnknown () ) { return this ; }
if ( isUnknown () || isUnresolved () ) { return this ; }
--File: src_com_google_javascript_jscomp_newtypes_JSType.java



if ( ! n . isVar () ) { return; }
if ( ! NodeUtil . isNameDeclaration ( n ) ) { return; }
--File: src_com_google_javascript_jscomp_RescopeGlobalSymbols.java



